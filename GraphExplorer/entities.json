{ "views": { "all": { "map": "function (doc, meta) {  var entities = [{0}]; for(var entity in entities) { var fields = entities[entity]; if(doc[fields[0]]) { var output = [doc[fields[0]], fields[1]]; if(fields[2] && doc[fields[2]]) { var date = dateToArray(doc[fields[2]]); for(d in date) output.push(date[d]); } emit(output, 1); } }}", "reduce": "_count" }, "raw": { "map": "function (doc, meta) { emit(meta.id, null); }" } } }